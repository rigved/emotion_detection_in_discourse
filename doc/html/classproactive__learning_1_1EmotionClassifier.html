<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Proactive Learning with Emotion Detection in non-cooperative Discourse: proactive_learning.EmotionClassifier Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Proactive Learning with Emotion Detection in non-cooperative Discourse
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">Emotion classifier for non-cooperative discourse settings and emotion annotated dataset.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceproactive__learning.html">proactive_learning</a></li><li class="navelem"><a class="el" href="classproactive__learning_1_1EmotionClassifier.html">EmotionClassifier</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classproactive__learning_1_1EmotionClassifier-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">proactive_learning.EmotionClassifier Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for proactive_learning.EmotionClassifier:</div>
<div class="dyncontent">
<div class="center"><img src="classproactive__learning_1_1EmotionClassifier__inherit__graph.png" border="0" usemap="#proactive__learning_8EmotionClassifier_inherit__map" alt="Inheritance graph"/></div>
<map name="proactive__learning_8EmotionClassifier_inherit__map" id="proactive__learning_8EmotionClassifier_inherit__map">
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for proactive_learning.EmotionClassifier:</div>
<div class="dyncontent">
<div class="center"><img src="classproactive__learning_1_1EmotionClassifier__coll__graph.png" border="0" usemap="#proactive__learning_8EmotionClassifier_coll__map" alt="Collaboration graph"/></div>
<map name="proactive__learning_8EmotionClassifier_coll__map" id="proactive__learning_8EmotionClassifier_coll__map">
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af3684b1fd605d7fbc53cb5892f1823da"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classproactive__learning_1_1EmotionClassifier.html#af3684b1fd605d7fbc53cb5892f1823da">__init__</a> (self, plutchik_emotions=['Acceptance', Aggressiveness, Annoyance, Apprehension, Awe, Boredom, Contempt, Disapproval, Distraction, Friendliness, Hostility, Interest, Optimism, Pensiveness, Remorse, Serenity, Submission, oracles=['models/distilbert/easy_to_difficult_sampling', models, distilbert, entropy_sampling, models, distilbert, margin_sampling, models, distilbert, uncertainty_sampling, reliability_scores=[0.0, proactive_learning_model_checkpoint='models/distilbert/proactive_learning', tokenizer=AutoTokenizer.from_pretrained('distilbert-base-uncased'), model=AutoModelForSequenceClassification.from_pretrained('distilbert-base-uncased', num_labels=17, problem_type='multi_label_classification'), device=torch.device('cuda:0'), batch_size=8, lr=5e-5, num_warmup_steps=0, n_iter=5, verbose=True)</td></tr>
<tr class="separator:af3684b1fd605d7fbc53cb5892f1823da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f095bbf90e8d078925f041d58412159"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classproactive__learning_1_1EmotionClassifier.html#a6f095bbf90e8d078925f041d58412159">fit</a> (self, X, y)</td></tr>
<tr class="separator:a6f095bbf90e8d078925f041d58412159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada343a07ec46adc5128c8b85b21d3f92"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classproactive__learning_1_1EmotionClassifier.html#ada343a07ec46adc5128c8b85b21d3f92">predict</a> (self, X)</td></tr>
<tr class="separator:ada343a07ec46adc5128c8b85b21d3f92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e28ab3ad1813db519dcecdf4582fa2c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classproactive__learning_1_1EmotionClassifier.html#a8e28ab3ad1813db519dcecdf4582fa2c">predict_proba</a> (self, X)</td></tr>
<tr class="separator:a8e28ab3ad1813db519dcecdf4582fa2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3b4287e88a2cd55d245380b8c714b72"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classproactive__learning_1_1EmotionClassifier.html#ae3b4287e88a2cd55d245380b8c714b72">collate_batch</a> (self, batch)</td></tr>
<tr class="separator:ae3b4287e88a2cd55d245380b8c714b72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afea65baaf69c64e1147b4d2f00af84df"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classproactive__learning_1_1EmotionClassifier.html#afea65baaf69c64e1147b4d2f00af84df">score</a> (self, y_true, y_predictions, kwargs)</td></tr>
<tr class="separator:afea65baaf69c64e1147b4d2f00af84df"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a5ffea568cd0d0fb6f307e4c3b74360fe"><td class="memItemLeft" align="right" valign="top"><a id="a5ffea568cd0d0fb6f307e4c3b74360fe"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>plutchik_emotions</b></td></tr>
<tr class="separator:a5ffea568cd0d0fb6f307e4c3b74360fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bd3eed01cd9fb9cf8cd18f9203e8eb4"><td class="memItemLeft" align="right" valign="top"><a id="a7bd3eed01cd9fb9cf8cd18f9203e8eb4"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>oracles</b></td></tr>
<tr class="separator:a7bd3eed01cd9fb9cf8cd18f9203e8eb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa219783f40a1aa32c19961186a69c9ff"><td class="memItemLeft" align="right" valign="top"><a id="aa219783f40a1aa32c19961186a69c9ff"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>reliability_scores</b></td></tr>
<tr class="separator:aa219783f40a1aa32c19961186a69c9ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a829db2ee3d41e5250ed3bb721d6e3bda"><td class="memItemLeft" align="right" valign="top"><a id="a829db2ee3d41e5250ed3bb721d6e3bda"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>proactive_learning_model_checkpoint</b></td></tr>
<tr class="separator:a829db2ee3d41e5250ed3bb721d6e3bda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae788f9dd9b7b810a706e852167f5a54b"><td class="memItemLeft" align="right" valign="top"><a id="ae788f9dd9b7b810a706e852167f5a54b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>tokenizer</b></td></tr>
<tr class="separator:ae788f9dd9b7b810a706e852167f5a54b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16a5829555f1a4e31e9bd842bc107a3d"><td class="memItemLeft" align="right" valign="top"><a id="a16a5829555f1a4e31e9bd842bc107a3d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>device</b></td></tr>
<tr class="separator:a16a5829555f1a4e31e9bd842bc107a3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b8671deb7a127e3523595d95a45a7cd"><td class="memItemLeft" align="right" valign="top"><a id="a7b8671deb7a127e3523595d95a45a7cd"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>model</b></td></tr>
<tr class="separator:a7b8671deb7a127e3523595d95a45a7cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b4c6c31dc7c3253f662e871235b6e83"><td class="memItemLeft" align="right" valign="top"><a id="a1b4c6c31dc7c3253f662e871235b6e83"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>batch_size</b></td></tr>
<tr class="separator:a1b4c6c31dc7c3253f662e871235b6e83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabc214010469c76091b9ad63462678cb"><td class="memItemLeft" align="right" valign="top"><a id="aabc214010469c76091b9ad63462678cb"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>lr</b></td></tr>
<tr class="separator:aabc214010469c76091b9ad63462678cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44bde7a04b173f989b627286b8b2ddba"><td class="memItemLeft" align="right" valign="top"><a id="a44bde7a04b173f989b627286b8b2ddba"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>n_iter</b></td></tr>
<tr class="separator:a44bde7a04b173f989b627286b8b2ddba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d010eb1e5960e6ee4197add442fe976"><td class="memItemLeft" align="right" valign="top"><a id="a5d010eb1e5960e6ee4197add442fe976"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>num_warmup_steps</b></td></tr>
<tr class="separator:a5d010eb1e5960e6ee4197add442fe976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d5aa7a287557fa486816becc75ff336"><td class="memItemLeft" align="right" valign="top"><a id="a7d5aa7a287557fa486816becc75ff336"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>verbose</b></td></tr>
<tr class="separator:a7d5aa7a287557fa486816becc75ff336"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab29939b04469f387b38701b02b19dfcb"><td class="memItemLeft" align="right" valign="top"><a id="ab29939b04469f387b38701b02b19dfcb"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>training_loss_</b></td></tr>
<tr class="separator:ab29939b04469f387b38701b02b19dfcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2412fdc72f3113c08f6f47e95d522bee"><td class="memItemLeft" align="right" valign="top"><a id="a2412fdc72f3113c08f6f47e95d522bee"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>oracle_selection_history_</b></td></tr>
<tr class="separator:a2412fdc72f3113c08f6f47e95d522bee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Multi-label classifier for emotions that fine-tunes hugging face pre-trained transformer model checkpoints.
This class is intended to be used as the base estimator of a modAL Active Learner. This class provides a
scikit-learn API to the underlying transformer model.
</pre> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="af3684b1fd605d7fbc53cb5892f1823da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3684b1fd605d7fbc53cb5892f1823da">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def proactive_learning.EmotionClassifier.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>plutchik_emotions</em> = <code>[
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'Acceptance'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Aggressiveness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Annoyance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Apprehension</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Awe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Boredom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Contempt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Disapproval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Distraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Friendliness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Hostility</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Interest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Optimism</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Pensiveness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Remorse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Serenity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Submission</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>oracles</em> = <code>[
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'models/distilbert/easy_to_difficult_sampling'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>models</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distilbert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>entropy_sampling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>models</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distilbert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>margin_sampling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>models</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>distilbert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>uncertainty_sampling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reliability_scores</em> = <code>[
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>proactive_learning_model_checkpoint</em> = <code>'models/distilbert/proactive_learning'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tokenizer</em> = <code>AutoTokenizer.from_pretrained('distilbert-base-uncased')</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>model</em> = <code>AutoModelForSequenceClassification.from_pretrained(
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'distilbert-base-uncased',
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;num_labels=17,
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;problem_type='multi_label_classification'
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>device</em> = <code>torch.device('cuda:0')</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>batch_size</em> = <code>8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lr</em> = <code>5e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_warmup_steps</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_iter</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Initialize the underlying hugging face transformer model checkpoint.

:param plutchik_emotions: Emotion labels from Plutchik's wheel of emotions.
:param oracles: The list of Proactive Learning oracles. Not used in the Active Learning case.
:param reliability_scores: The reliability scores of each of the Proactive Learning oracles.
                   Not used in the Active Learning case.
:param proactive_learning_model_checkpoint: The current Proactive Learning model's checkpoint name.
                                    This helps to load the model after it was unloaded
                                    temporarily to accommodate the oracle's model on the
                                    single instance of the GPU.
                                    Not used in the Active Learning case.
:param tokenizer: The underlying model's tokenizer. Default checkpoint: distilbert-base-uncased.
:param model: The underlying model. Default checkpoint: distilbert-base-uncased.
      By default, the model's classification head is configured to output 17 labels as defined
      in the list of chosen Plutchik emotions.
:param device: The CUDA-enabled GPU device to use for this model. Default: 1st available CUDA-enabled GPU.
:param batch_size: The number of instances in each batch.
           Default: 8 (This batch size fits into the memory offered by an NVIDIA P4 GPU.)
:param lr: Learning rate for the transformer head's optimizer. Default: 5e-5
:param num_warmup_steps: Number of warmup steps for the learning rate scheduler during training.
:param n_iter: Number of epochs for the training. Default: 3
:param verbose: Output training progress and training loss if this is True.
</pre> 
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae3b4287e88a2cd55d245380b8c714b72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3b4287e88a2cd55d245380b8c714b72">&#9670;&nbsp;</a></span>collate_batch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def proactive_learning.EmotionClassifier.collate_batch </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>batch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Data collator function that takes a batch of variable-length tokenized
tensors (variable-length tokenized input strings of sizes 'size_1',
'size_2', ..., 'size_n') and pads them to be the same length as the
largest sequence of tokens in the batch. Here, 'n' is the current
batch size.
Since tensors on GPUs need to be of the same length, the input
variable-length tensors are stored on the CPU as a list of tensors,
padded, and then moved to the first available GPU.

:param batch: List of variable length tokenized text. Represented as
      batch = [
        {
            'input_ids': Tensor[1, size_1],
            'attention_mask': Tensor[1, size_1],
            'labels: Tensor[1]'
        },
        {
            'input_ids': Tensor[1, size_2],
            'attention_mask': Tensor[1, size_2],
            'labels: Tensor[1]'
        },
        ...,
        {
            'input_ids': Tensor[1, size_n],
            'attention_mask': Tensor[1, size_n],
            'labels: Tensor[1]'
        }
      ]
:return: Tokenized text with padding. Represented as
 return {
    'input_ids': Tensor[batch_size, max_padded_size_of_this_batch],
    'attention_mask': Tensor[batch_size, max_padded_size_of_this_batch],
    'labels': Tensor[batch_size]
 }
</pre> 
</div>
</div>
<a id="a6f095bbf90e8d078925f041d58412159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f095bbf90e8d078925f041d58412159">&#9670;&nbsp;</a></span>fit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def proactive_learning.EmotionClassifier.fit </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Incrementally fine-tune the underlying transformer model. This class deviates from the scikit-learn guidelines
because it doesn't fit a new model on every call to this method. Ideally, `partial_fit` should be called for
incremental learning. However, modAL calls the `fit` method instead of the `partial_fit` method. Hence, the
deviation.

:param X: A Pandas series consisting of the question and response text.
:param y: A Pandas series for the corresponding emotion labels (one-hot encoded multi-label array).

:return: Fitted model.
</pre> 
</div>
</div>
<a id="ada343a07ec46adc5128c8b85b21d3f92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada343a07ec46adc5128c8b85b21d3f92">&#9670;&nbsp;</a></span>predict()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def proactive_learning.EmotionClassifier.predict </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Predict the emotion detected in the given text.

:param X: A Pandas series consisting of the question and response text.

:return: Predicted labels.
</pre> 
</div>
</div>
<a id="a8e28ab3ad1813db519dcecdf4582fa2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e28ab3ad1813db519dcecdf4582fa2c">&#9670;&nbsp;</a></span>predict_proba()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def proactive_learning.EmotionClassifier.predict_proba </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>X</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the probabilities of the labels for the given text. These are multi-label probabilities.

:param X: A Pandas series consisting of the question and response text.

:return: Probabilities for each label, with shape (X.shape[0], n_classes)
</pre> 
</div>
</div>
<a id="afea65baaf69c64e1147b4d2f00af84df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afea65baaf69c64e1147b4d2f00af84df">&#9670;&nbsp;</a></span>score()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def proactive_learning.EmotionClassifier.score </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_true</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_predictions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate metrics for multilabel classification. Metrics calculated are:
    * Exact Match Ratio
    * 0/1 Loss
    * Hamming score (Subset Accuracy)
    * Hamming Loss
    * Precision
    * Recall
    * F1-Measure
Since the sklearn versions don't work with this dataset, these metrics are manually calculated.

:param y_predictions: The predictions from the model.
:param y_true: The gold standard labels.
:param kwargs: Keyword arguments for the "ClassifierMinix.score" method.
       By default, it can accept optional array-like sample
       weights of shape (n_samples,). Default: None
       This is currently not used in this method.

:return: Metrics.
</pre> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/proactive_learning.py</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
